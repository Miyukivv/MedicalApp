<!doctype html>
<html lang="pl" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Aplikacja medyczna - logowanie</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
</head>

<body class="login-body">

<div class="login">
    <section class="login-left">
        <div class="login-left__inner">
            <div class="login-logo">Logo</div>

            <h1 class="login-title">
                Cześć,<br>
                <span>Witaj ponownie!</span>
            </h1>

            <p class="login-desc">
                <b style="font-size:x-large">Twoje zdrowie w jednym miejscu.</b><br>
                Zarządzaj wizytami, lekami i dokumentacją medyczną w prosty i bezpieczny sposób. Niezależnie czy jesteś pacjentem czy lekarzem - wszystko, czego potrzebujesz, masz pod ręką.
            </p>
        </div>
    </section>

    <!-- PRAWA STRONA -->
    <section class="login-right">
        <div class="login-right__inner">

            <!-- komunikaty Spring Security -->
            <div class="login-alert" th:if="${param.error}">
                Nieprawidłowy e-mail lub hasło.
            </div>
            <div class="login-alert login-alert--ok" th:if="${param.logout}">
                Wylogowano pomyślnie.
            </div>

            <form class="login-form" th:action="@{/perform_login}" method="post">
                <!-- Email -->
                <div class="field">
                    <span class="field__label">Adres e-mail</span>
                    <input id="loginEmail" class="field__input" type="email" name="email" placeholder="example@mail.com" required>
                </div>

                <!-- Hasło -->
                <div class="field">
                    <span class="field__label">Hasło</span>
                    <input class="field__input" type="password" name="password" placeholder="••••••••" required>
                </div>

                <div class="login-row">
                    <label class="check">
                        <input id="rememberEmail" type="checkbox" name="remember-me">
                        <span>Zapamiętaj mnie</span>
                    </label>

                    <a class="login-link" th:href="@{/forgot-password}">Zapomniałeś hasła?</a>
                </div>

                <div class="login-actions">
                    <button class="login-btn login-btn--primary" type="submit">Zaloguj</button>
                    <a class="login-btn login-btn--outline" th:href="@{/register}">Zarejestruj</a>
                </div>
            </form>

        </div>
    </section>
</div>

<script>
    (function () {
        const emailInput = document.getElementById('loginEmail');
        const rememberBox = document.getElementById('rememberEmail');

        if (!emailInput || !rememberBox) return;

        // Wczytaj zapisany email
        const saved = localStorage.getItem('rememberedEmail');
        if (saved) {
            emailInput.value = saved;
            rememberBox.checked = true;
        }

        // Zapisuj/usuń przy zmianie
        function sync() {
            if (rememberBox.checked) {
                localStorage.setItem('rememberedEmail', emailInput.value.trim());
            } else {
                localStorage.removeItem('rememberedEmail');
            }
        }

        rememberBox.addEventListener('change', sync);
        emailInput.addEventListener('input', () => {
            if (rememberBox.checked) sync();
        });

        // Przy wysłaniu formularza też zapisz (na wszelki wypadek)
        emailInput.form?.addEventListener('submit', sync);
    })();
</script>

</body>
</html>
